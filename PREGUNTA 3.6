from scipy import signal
import matplotlib.pyplot as plt
import math
import numpy as np
n = np.linspace(0,40,41)
# VALOR PARA EL RETARDO
k=10
# PARA FRECUENCIA F1=0.1Hz  F2=0.2Hz  F3=0.3Hz
xn = np.cos(2*math.pi*0.1*n)+np.cos(2*math.pi*0.15*n)+np.cos(2*math.pi*0.3*n)

M=4

xnk= np.concatenate((np.zeros(k),xn))
xnk.shape

num = np.ones(M)
den=1

yn = signal.lfilter(num,den,xn)/M;
ynk = signal.lfilter(num,den,xnk)/M;
difn = yn - ynk[k:41+k]

plt.subplot(3,1,1)
plt.stem(n,yn)
plt.xlabel('Time [n]')
plt.ylabel('Señal Filtrada')

plt.subplot(3,1,2)
plt.stem(n,ynk[1:42])
plt.xlabel('Time [n]')
plt.ylabel('Señal retardada')

plt.subplot(3,1,3)
plt.plot(n,difn,'.')
plt.xlabel('Time [n]')
plt.ylabel('Señal diferencia')
